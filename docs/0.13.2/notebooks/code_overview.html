
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>An overview of Trieste types &#8212; trieste 0.13.2 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/styles/pydata-sphinx-theme.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Tracking and visualizing optimizations using Tensorboard" href="visualizing_with_tensorboard.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/logo.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../index.html">
  Trieste
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../autoapi/trieste/index.html">
  API reference
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../tutorials.html">
  Tutorials
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <div class="dropdown" id="version_switcher">
    <button type="button" class="btn btn-primary btn-sm navbar-btn dropdown-toggle" id="version_switcher_button" data-toggle="dropdown">
        0.13.2  <!-- this text may get changed later by javascript -->
        <span class="caret"></span>
    </button>
    <div id="version_switcher_menu" class="dropdown-menu list-group-flush py-0" aria-labelledby="version_switcher_button">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
</div>

<!-- NOTE: this JS must live here (not in our global JS file) because it relies
     on being processed by Jinja before it is run (specifically for replacing
     variables notebooks/code_overview and {'json_url': 'https://secondmind-labs.github.io/trieste/versions.json', 'version_match': '0.13.2'}.
-->

<script type="text/javascript">
// Check if corresponding page path exists in other version of docs
// and, if so, go there instead of the homepage of the other docs version
function checkPageExistsAndRedirect(event) {
    const currentFilePath = "notebooks/code_overview.html",
          tryUrl = event.target.getAttribute("href");
    let otherDocsHomepage = tryUrl.replace(currentFilePath, "");
    $.ajax({
        type: 'HEAD',
        url: tryUrl,
        // if the page exists, go there
        success: function() {
            location.href = tryUrl;
        }
    }).fail(function() {
        location.href = otherDocsHomepage;
    });
    // this prevents the browser from following the href of the clicked node
    // (which is fine because this function takes care of redirecting)
    return false;
}

// Populate the version switcher from the JSON config file
(function () {
    $.getJSON("https://secondmind-labs.github.io/trieste/versions.json", function(data, textStatus, jqXHR) {
        const currentFilePath = "notebooks/code_overview.html";
        // create links to the corresponding page in the other docs versions
        $.each(data, function(index, entry) {
            // if no custom name specified (e.g., "latest"), use version string
            if (!("name" in entry)) {
                entry.name = entry.version;
            }
            // create the node
            const node = document.createElement("a");
            node.setAttribute("class", "list-group-item list-group-item-action py-1");
            node.textContent = `${entry.name}`;
            node.setAttribute("href", `${entry.url}${currentFilePath}`);
            // on click, AJAX calls will check if the linked page exists before
            // trying to redirect, and if not, will redirect to the homepage
            // for that version of the docs.
            node.onclick = checkPageExistsAndRedirect;
            // Add dataset values for the version and name in case people want
            // to apply CSS styling based on this information.
            node.dataset["versionName"] = entry.name;
            node.dataset["version"] = entry.version;

            $("#version_switcher_menu").append(node);
            // replace dropdown button text with the preferred display name of
            // this version, rather than using sphinx's  variable.
            // also highlight the dropdown entry for the currently-viewed
            // version's entry
            if (entry.version == "0.13.2") {
                node.classList.add("active");
                let btn = document.getElementById("version_switcher_button");
                btn.innerText = btn.dataset["activeVersionName"] = entry.name;
                btn.dataset["activeVersion"] = entry.version;
            }
        });
    });
})();
</script>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/secondmind-labs/trieste" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="expected_improvement.html">
   Noise-free optimization with Expected Improvement
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="batch_optimization.html">
   Batch Bayesian Optimization with Batch Expected Improvement, Local Penalization, Kriging Believer and GIBBON
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="thompson_sampling.html">
   Batch-sequential optimization with Thompson sampling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inequality_constraints.html">
   Inequality constraints
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="failure_ego.html">
   EGO with a failure region
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="multi_objective_ehvi.html">
   Multi-objective optimization with Expected HyperVolume Improvement
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="deep_gaussian_processes.html">
   Using deep Gaussian processes with GPflux for Bayesian optimization.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="deep_ensembles.html">
   Bayesian optimization with deep ensembles
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="active_learning.html">
   Active Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="active_learning_for_binary_classification.html">
   Active Learning for Gaussian Process Classification Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="feasible_sets.html">
   Bayesian active learning of failure or feasibility regions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="openai_gym_lunar_lander.html">
   Trieste meets OpenAI Gym
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="scalable_thompson_sampling_using_sparse_gaussian_processes.html">
   Scalable Thompson Sampling using Sparse Gaussian Process Models
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="ask_tell_optimization.html">
   Ask-Tell Optimization Interface
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="data_transformation.html">
   Data transformation with the help of Ask-Tell interface.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="recovering_from_errors.html">
   Recovering from errors during optimization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="asynchronous_greedy_multiprocessing.html">
   Asynchronous Bayesian optimization with Trieste
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="asynchronous_nongreedy_batch_ray.html">
   Asynchronous batch Bayesian optimization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="visualizing_with_tensorboard.html">
   Tracking and visualizing optimizations using Tensorboard
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   An overview of Trieste types
  </a>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Key-types">
   Key types
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Observer">
     <code class="docutils literal notranslate">
      <span class="pre">
       Observer
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#Dataset">
     <code class="docutils literal notranslate">
      <span class="pre">
       Dataset
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ProbabilisticModel">
     <code class="docutils literal notranslate">
      <span class="pre">
       ProbabilisticModel
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#SearchSpace">
     <code class="docutils literal notranslate">
      <span class="pre">
       SearchSpace
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#AcquisitionRule">
     <code class="docutils literal notranslate">
      <span class="pre">
       AcquisitionRule
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#AcquisitionFunction-and-AcquisitionFunctionBuilder">
     <code class="docutils literal notranslate">
      <span class="pre">
       AcquisitionFunction
      </span>
     </code>
     and
     <code class="docutils literal notranslate">
      <span class="pre">
       AcquisitionFunctionBuilder
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#AcquisitionOptimizer">
     <code class="docutils literal notranslate">
      <span class="pre">
       AcquisitionOptimizer
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#BayesianOptimizer-and-AskTellOptimizer">
     <code class="docutils literal notranslate">
      <span class="pre">
       BayesianOptimizer
      </span>
     </code>
     and
     <code class="docutils literal notranslate">
      <span class="pre">
       AskTellOptimizer
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#Extending-the-key-types">
   Extending the key types
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#New-observers">
     New observers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#New-probabilistic-model-types">
     New probabilistic model types
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#New-acquisition-function-builders">
     New acquisition function builders
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#LICENSE">
   LICENSE
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="An-overview-of-Trieste-types">
<h1>An overview of Trieste types<a class="headerlink" href="#An-overview-of-Trieste-types" title="Permalink to this headline">#</a></h1>
<p>Trieste is dedicated to Bayesian optimization, the process of finding the <em>optimal values of an expensive, black-box objective function by employing probabilistic models over observations</em>. This notebook explains how the different parts of this process are represented by different types in the code, and how these types can be extended.</p>
<div class="section" id="Key-types">
<h2>Key types<a class="headerlink" href="#Key-types" title="Permalink to this headline">#</a></h2>
<p>The following types represent the key concepts in Trieste. For a full listing of all the types in Trieste, see the API reference.</p>
<div class="section" id="Observer">
<h3><code class="docutils literal notranslate"><span class="pre">Observer</span></code><a class="headerlink" href="#Observer" title="Permalink to this headline">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Observer</span></code> type definition represents the black box objective function. Observers are functions that accept query points and return datasets that contain the observations. Observations are either a single objective value that we wish to optimize, or a dictionary of mutiple tagged values that must be combined somehow, for example an objective and an inequality constraint. Objective values can be either single or multi-dimensional (see <a class="reference internal" href="multi_objective_ehvi.html"><span class="doc">multi-objective
optimization</span></a>).</p>
</div>
<div class="section" id="Dataset">
<h3><code class="docutils literal notranslate"><span class="pre">Dataset</span></code><a class="headerlink" href="#Dataset" title="Permalink to this headline">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> container class represents the query points and observations from a single observer. Observers with multiple observations are represented by a dictionary of multiple tagged <code class="docutils literal notranslate"><span class="pre">Dataset</span></code>s.</p>
</div>
<div class="section" id="ProbabilisticModel">
<h3><code class="docutils literal notranslate"><span class="pre">ProbabilisticModel</span></code><a class="headerlink" href="#ProbabilisticModel" title="Permalink to this headline">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">ProbabilisticModel</span></code> protocol represents any probabilistic model used to model observations. Like for <code class="docutils literal notranslate"><span class="pre">Dataset</span></code>, observers with multiple observations are modelled by a dictionary of multiple tagged models.</p>
<p>At it simplest, a <code class="docutils literal notranslate"><span class="pre">ProbabilisticModel</span></code> is anything that implements a <code class="docutils literal notranslate"><span class="pre">predict</span></code> and <code class="docutils literal notranslate"><span class="pre">sample</span></code> method. However, many algorithms in Trieste depend on models with additional features, which are represented by the various subclasses of <code class="docutils literal notranslate"><span class="pre">ProbabilisticModel</span></code>. The standard Bayesian optimizer uses <code class="docutils literal notranslate"><span class="pre">TrainableProbabilisticModel</span></code> models, which also implement an <code class="docutils literal notranslate"><span class="pre">update</span></code> method (to update the model structure when new data is added to the training set) and an <code class="docutils literal notranslate"><span class="pre">optimize</span></code> method (to optimize the
model training loss). Specific acuqisition functions may require other features, represented by classes like <code class="docutils literal notranslate"><span class="pre">SupportsPredictJoint</span></code> (ability to predict the joint distribution at several inputs) and <code class="docutils literal notranslate"><span class="pre">SupportsGetObservationNoise</span></code> (ability to predict the observation noise variance). Since these are defined as protocols, it is possible to define and depend on the intersections of different model types (e.g. only support models that are both <code class="docutils literal notranslate"><span class="pre">SupportsPredictJoint</span></code> and
<code class="docutils literal notranslate"><span class="pre">SupportsGetObservationNoise</span></code>).</p>
<p>Multiple models can also be combined into a single <code class="docutils literal notranslate"><span class="pre">ModelStack</span></code> model that combines their outputs for prediction and sampling. This can be useful when modelling multi-objective observations with independent single-output models. There are also constructors like <code class="docutils literal notranslate"><span class="pre">TrainableModelStack</span></code> and <code class="docutils literal notranslate"><span class="pre">PredictJointModelStack</span></code> that combine specific types of model for use with code that requires that type, delegating the relevant methods where appropriate.</p>
</div>
<div class="section" id="SearchSpace">
<h3><code class="docutils literal notranslate"><span class="pre">SearchSpace</span></code><a class="headerlink" href="#SearchSpace" title="Permalink to this headline">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">SearchSpace</span></code> base class represents the domain over which the objective function is to be optimized. Spaces can currently be either continuous <code class="docutils literal notranslate"><span class="pre">Box</span></code> spaces, discrete <code class="docutils literal notranslate"><span class="pre">DiscreteSearchSpace</span></code> spaces, or a <code class="docutils literal notranslate"><span class="pre">TaggedProductSearchSpace</span></code> product of multipe spaces. All search spaces expose their dimensions, bounds and a sampler.</p>
</div>
<div class="section" id="AcquisitionRule">
<h3><code class="docutils literal notranslate"><span class="pre">AcquisitionRule</span></code><a class="headerlink" href="#AcquisitionRule" title="Permalink to this headline">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">AcquisitionRule</span></code> base class represents a routine for selecting new query points during a Bayesian optimization loop (via an <code class="docutils literal notranslate"><span class="pre">acquire</span></code> method). It is generic on three types:</p>
<ul class="simple">
<li><p><strong>ResultType</strong>: the output of the rule, typically this is just tensors representing the query points. However, it can also be functions that accept some <em>acquisition state</em> and return the query points with a new state.</p></li>
<li><p><strong>SearchSpaceType</strong>: the type of the search space; any optimizer that the rule uses must support this.</p></li>
<li><p><strong>ProbabilisticModelType</strong>: the type of the models; any acquisition functions or samplers that the rule uses must support this.</p></li>
</ul>
<p>Examples of rules include:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">EfficientGlobalOptimization</span></code> (EGO) is the most commonly used rule, and uses acquisition functions and optimizers to select new query points.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">AsynchronousOptimization</span></code> is similar to EGO but uses acquisition state to keep track of points whose observations are still pending.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DiscreteThompsonSampling</span></code> uses Thompson samplers rather than acquisition functions to select new query points.</p></li>
</ol>
</div>
<div class="section" id="AcquisitionFunction-and-AcquisitionFunctionBuilder">
<h3><code class="docutils literal notranslate"><span class="pre">AcquisitionFunction</span></code> and <code class="docutils literal notranslate"><span class="pre">AcquisitionFunctionBuilder</span></code><a class="headerlink" href="#AcquisitionFunction-and-AcquisitionFunctionBuilder" title="Permalink to this headline">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">AcquisitionFunction</span></code> type definition represents any acquisition function: that is, a function that maps a set of query points to a single value that describes how useful it would be evaluate all these points together.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">AcquisitionFunctionBuilder</span></code> base class, meanwhile, represents something that builds and updates acquisition functions. At the start of the Bayesian optimization, the builder’s <code class="docutils literal notranslate"><span class="pre">prepare_acquisition_function</span></code> method is called by the acquisition rule to create an acquisition function from the current observations and probabilistic models. To avoid unnecessary tensorflow compilations, most builders also define an <code class="docutils literal notranslate"><span class="pre">update_acquisition_function</span></code> method for updating the function using the
updated observations and models. (The ones that don’t instead generate a new acquisition function when necessary.)</p>
<p>Acquisition functions that support only one probabilistic model are more easily defined using the <code class="docutils literal notranslate"><span class="pre">SingleModelAcquisitionBuilder</span></code> convenience class, which avoids having to deal with dictionaries.</p>
<p>Acquisition functions that are suitable for greedily building batches of points can be defined using <code class="docutils literal notranslate"><span class="pre">GreedyAcquisitionFunctionBuilder</span></code> (or <code class="docutils literal notranslate"><span class="pre">SingleModelGreedyAcquisitionBuilder</span></code>) using a <code class="docutils literal notranslate"><span class="pre">prepare_acquisition_function</span></code> method that also accepts the points already chosen to be in the current batch.</p>
</div>
<div class="section" id="AcquisitionOptimizer">
<h3><code class="docutils literal notranslate"><span class="pre">AcquisitionOptimizer</span></code><a class="headerlink" href="#AcquisitionOptimizer" title="Permalink to this headline">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">AcquisitionOptimizer</span></code> type definition represents an optimizer function that maximizes an acquisition function over a search space. Trieste provides a <code class="docutils literal notranslate"><span class="pre">generate_continuous_optimizer</span></code> function for generating gradient-based optimizers for continuous (or hybrid) spaces, an <code class="docutils literal notranslate"><span class="pre">optimize_discrete</span></code> function for optimizing discrete spaces, and <code class="docutils literal notranslate"><span class="pre">automatic_optimizer_selector</span></code> for quickly selecting an appropriate optimizer.</p>
</div>
<div class="section" id="BayesianOptimizer-and-AskTellOptimizer">
<h3><code class="docutils literal notranslate"><span class="pre">BayesianOptimizer</span></code> and <code class="docutils literal notranslate"><span class="pre">AskTellOptimizer</span></code><a class="headerlink" href="#BayesianOptimizer-and-AskTellOptimizer" title="Permalink to this headline">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">BayesianOptimizer</span></code> and <code class="docutils literal notranslate"><span class="pre">AskTellOptimizer</span></code> classes are the two Bayesian optimization interfaces provided by Trieste. Both classes provide <a class="reference internal" href="visualizing_with_tensorboard.html"><span class="doc">monitoring using TensorBoard</span></a>.</p>
<p><code class="docutils literal notranslate"><span class="pre">BayesianOptimizer</span></code> exposes an <code class="docutils literal notranslate"><span class="pre">optimize</span></code> method for running a Bayesian optimization loop with given initial datasets and models, and a given number of steps (and an optional early stop callback).</p>
<p><code class="docutils literal notranslate"><span class="pre">AskTellOptimizer</span></code> provides <a class="reference internal" href="ask_tell_optimization.html"><span class="doc">greater control</span></a> over the loop, by providing separate <code class="docutils literal notranslate"><span class="pre">ask</span></code> and <code class="docutils literal notranslate"><span class="pre">tell</span></code> steps for suggesting query points and updating the models with new observations.</p>
</div>
</div>
<div class="section" id="Extending-the-key-types">
<h2>Extending the key types<a class="headerlink" href="#Extending-the-key-types" title="Permalink to this headline">#</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">trieste.types</span> <span class="kn">import</span> <span class="n">TensorType</span>
</pre></div>
</div>
</div>
<p>This section explains how to define new observers, model types and acqusition functions.</p>
<div class="section" id="New-observers">
<h3>New observers<a class="headerlink" href="#New-observers" title="Permalink to this headline">#</a></h3>
<p>Defining an observer with a single observation can be as simple as defining a function that returns that observation:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">trieste.objectives.utils</span> <span class="kn">import</span> <span class="n">mk_observer</span>


<span class="k">def</span> <span class="nf">simple_quadratic</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">TensorType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TensorType</span><span class="p">:</span>
    <span class="s2">&quot;A trivial quadratic function over :math:`[0, 1]^2`.&quot;</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>


<span class="n">observer</span> <span class="o">=</span> <span class="n">mk_observer</span><span class="p">(</span><span class="n">simple_quadratic</span><span class="p">)</span>
<span class="n">observer</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float64</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Dataset(query_points=&lt;tf.Tensor: shape=(2, 2), dtype=float64, numpy=
array([[0., 1.],
       [1., 1.]])&gt;, observations=&lt;tf.Tensor: shape=(2, 1), dtype=float64, numpy=
array([[-1.],
       [-4.]])&gt;)
</pre></div></div>
</div>
<p>A multi-observation observer can similarly be constructed from multiple functions:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">trieste.objectives.utils</span> <span class="kn">import</span> <span class="n">mk_multi_observer</span>


<span class="k">def</span> <span class="nf">simple_constraint</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">TensorType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TensorType</span><span class="p">:</span>
    <span class="s2">&quot;A trivial constraints over :math:`[0, 1]^2`.&quot;</span>
    <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">reduce_min</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="n">multiobserver</span> <span class="o">=</span> <span class="n">mk_multi_observer</span><span class="p">(</span>
    <span class="n">OBJECTIVE</span><span class="o">=</span><span class="n">simple_quadratic</span><span class="p">,</span> <span class="n">CONSTRAINT</span><span class="o">=</span><span class="n">simple_constraint</span>
<span class="p">)</span>
<span class="n">multiobserver</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float64</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;OBJECTIVE&#39;: Dataset(query_points=&lt;tf.Tensor: shape=(2, 2), dtype=float64, numpy=
 array([[0., 1.],
        [1., 1.]])&gt;, observations=&lt;tf.Tensor: shape=(2, 1), dtype=float64, numpy=
 array([[-1.],
        [-4.]])&gt;),
 &#39;CONSTRAINT&#39;: Dataset(query_points=&lt;tf.Tensor: shape=(2, 2), dtype=float64, numpy=
 array([[0., 1.],
        [1., 1.]])&gt;, observations=&lt;tf.Tensor: shape=(2, 1), dtype=float64, numpy=
 array([[0.],
        [1.]])&gt;)}
</pre></div></div>
</div>
<p>Note however that observers are not restricted to returning datasets containing precisely the observed query points: if need be, they can also return arbitrary Datasets with missing or additional points and observations.</p>
</div>
<div class="section" id="New-probabilistic-model-types">
<h3>New probabilistic model types<a class="headerlink" href="#New-probabilistic-model-types" title="Permalink to this headline">#</a></h3>
<p>Defining a new probabilistic model type simply involves writing a class that implements all the relevant methods (at the very least <code class="docutils literal notranslate"><span class="pre">predict</span></code> and <code class="docutils literal notranslate"><span class="pre">sample</span></code>). For clarity, it is best to also explicitly inherit from the supported feature protocols.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">trieste.models.interfaces</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">TrainableProbabilisticModel</span><span class="p">,</span>
    <span class="n">HasReparamSampler</span><span class="p">,</span>
    <span class="n">ReparametrizationSampler</span><span class="p">,</span>
    <span class="n">SupportsGetObservationNoise</span><span class="p">,</span>
<span class="p">)</span>


<span class="k">class</span> <span class="nc">GizmoModel</span><span class="p">(</span>
    <span class="n">TrainableProbabilisticModel</span><span class="p">,</span> <span class="n">HasReparamSampler</span><span class="p">,</span> <span class="n">SupportsGetObservationNoise</span>
<span class="p">):</span>
    <span class="s2">&quot;Made-up trainable model type that supports both reparam_sampler and get_observation_noise.&quot;</span>

    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">query_points</span><span class="p">:</span> <span class="n">TensorType</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">TensorType</span><span class="p">,</span> <span class="n">TensorType</span><span class="p">]:</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="nf">reparam_sampler</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ReparametrizationSampler</span><span class="p">[</span><span class="n">GizmoModel</span><span class="p">]:</span>
        <span class="o">...</span>

    <span class="o">...</span>  <span class="c1"># sample, update, optimize, get_observation_noise</span>
</pre></div>
</div>
</div>
<p>If the new model type has an additional feature on which you’d like to depend, e.g. in a new acquisition function, then you can define that feature as a protocol. Marking it runtime_checkable will alow you to check for the feature elsewhere in your code too.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">trieste.models.interfaces</span> <span class="kn">import</span> <span class="n">ProbabilisticModel</span>
<span class="kn">from</span> <span class="nn">typing_extensions</span> <span class="kn">import</span> <span class="n">Protocol</span><span class="p">,</span> <span class="n">runtime_checkable</span>


<span class="nd">@runtime_checkable</span>
<span class="k">class</span> <span class="nc">HasGizmo</span><span class="p">(</span><span class="n">ProbabilisticModel</span><span class="p">,</span> <span class="n">Protocol</span><span class="p">):</span>
    <span class="s2">&quot;A probabilistic model that has a &#39;gizmo&#39; method.&quot;</span>

    <span class="k">def</span> <span class="nf">gizmo</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="s2">&quot;A &#39;gizmo&#39; method.&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</pre></div>
</div>
</div>
<p>If your acquisition function depends on a combination of features, then you can define an intersection protocol and use it when defining the acquisition function:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@runtime_checkable</span>
<span class="k">class</span> <span class="nc">HasGizmoReparamSamplerAndObservationNoise</span><span class="p">(</span>
    <span class="n">HasGizmo</span><span class="p">,</span> <span class="n">HasReparamSampler</span><span class="p">,</span> <span class="n">SupportsGetObservationNoise</span><span class="p">,</span> <span class="n">Protocol</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A model that supports both gizmo, reparam_sampler and get_observation_noise.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="New-acquisition-function-builders">
<h3>New acquisition function builders<a class="headerlink" href="#New-acquisition-function-builders" title="Permalink to this headline">#</a></h3>
<p>To define a new acquisition function builder, you simply need to define a class with a <code class="docutils literal notranslate"><span class="pre">prepare_acquisition_function</span></code> method that returns an <code class="docutils literal notranslate"><span class="pre">AcquisitionFunction</span></code>. If the acquisition function depends on just one model/dataset (as is often the case) then you can define it as a <code class="docutils literal notranslate"><span class="pre">SingleModelAcquisitionBuilder</span></code>; if it depends on more than one (e.g. both an objective and a constraint) then you must define it as a <code class="docutils literal notranslate"><span class="pre">ModelAcquisitionBuilder</span></code> instead. You can also specify (in brackets) the type
of probabilistic models that the acquisition function supports: e.g. a <code class="docutils literal notranslate"><span class="pre">SingleModelAcquisitionBuilder[HasReparamSampler]</span></code> only supports models with a reparametrization sampler. This allows the type checker to warn you if you try to use an incompatible model type.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">trieste.acquisition</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">AcquisitionFunction</span><span class="p">,</span>
    <span class="n">SingleModelAcquisitionBuilder</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">trieste.data</span> <span class="kn">import</span> <span class="n">Dataset</span>


<span class="k">class</span> <span class="nc">ProbabilityOfValidity</span><span class="p">(</span><span class="n">SingleModelAcquisitionBuilder</span><span class="p">[</span><span class="n">ProbabilisticModel</span><span class="p">]):</span>
    <span class="k">def</span> <span class="nf">prepare_acquisition_function</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">ProbabilisticModel</span><span class="p">,</span> <span class="n">dataset</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dataset</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AcquisitionFunction</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">acquisition</span><span class="p">(</span><span class="n">at</span><span class="p">:</span> <span class="n">TensorType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TensorType</span><span class="p">:</span>
            <span class="n">mean</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_y</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">at</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">mean</span>

        <span class="k">return</span> <span class="n">acquisition</span>
</pre></div>
</div>
</div>
<p>For efficiency, it usually makes sense to compile the generated acquisition function into a TensorFlow graph using <code class="docutils literal notranslate"><span class="pre">tf.function</span></code>. Furthermore, to avoid generating (and compiling) a new acquisition function on each Bayesian optimization loop, you can define an <code class="docutils literal notranslate"><span class="pre">update_acquisition_function</span></code> method that can instead update the previously generated acquisition function using the new models and data. This may involve updating the acquisition function’s internal state (which you should store in
<code class="docutils literal notranslate"><span class="pre">tf.Variable</span></code>s), though if the function has no internal state then it is suficient to simply return the old function unchanged.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ProbabilityOfValidity2</span><span class="p">(</span><span class="n">SingleModelAcquisitionBuilder</span><span class="p">[</span><span class="n">ProbabilisticModel</span><span class="p">]):</span>
    <span class="k">def</span> <span class="nf">prepare_acquisition_function</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">ProbabilisticModel</span><span class="p">,</span> <span class="n">dataset</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dataset</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AcquisitionFunction</span><span class="p">:</span>
        <span class="nd">@tf</span><span class="o">.</span><span class="n">function</span>
        <span class="k">def</span> <span class="nf">acquisition</span><span class="p">(</span><span class="n">at</span><span class="p">:</span> <span class="n">TensorType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TensorType</span><span class="p">:</span>
            <span class="n">mean</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict_y</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">at</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">mean</span>

        <span class="k">return</span> <span class="n">acquisition</span>

    <span class="k">def</span> <span class="nf">update_acquisition_function</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">function</span><span class="p">:</span> <span class="n">AcquisitionFunction</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">ProbabilisticModel</span><span class="p">,</span>
        <span class="n">dataset</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dataset</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AcquisitionFunction</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">function</span>  <span class="c1"># no need to update anything</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="LICENSE">
<h2>LICENSE<a class="headerlink" href="#LICENSE" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://github.com/secondmind-labs/trieste/blob/develop/LICENSE">Apache License 2.0</a></p>
</div>
</div>


              </div>
              
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright Copyright 2020 The Trieste Contributors

Licensed under the Apache License, Version 2.0 (the &#34;License&#34;);
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an &#34;AS IS&#34; BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.4.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>