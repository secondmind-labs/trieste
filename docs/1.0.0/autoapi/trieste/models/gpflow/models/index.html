
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>trieste.models.gpflow.models &#8212; trieste 1.0.0 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../../../_static/styles/pydata-sphinx-theme.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/graphviz.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
    <script src="../../../../../_static/jquery.js"></script>
    <script src="../../../../../_static/underscore.js"></script>
    <script src="../../../../../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../../../../index.html">
  <img src="../../../../../_static/logo.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../../../index.html">
  Trieste
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../index.html">
  API reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../../../tutorials.html">
  Tutorials
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <div class="dropdown" id="version_switcher">
    <button type="button" class="btn btn-primary btn-sm navbar-btn dropdown-toggle" id="version_switcher_button" data-toggle="dropdown">
        1.0.0  <!-- this text may get changed later by javascript -->
        <span class="caret"></span>
    </button>
    <div id="version_switcher_menu" class="dropdown-menu list-group-flush py-0" aria-labelledby="version_switcher_button">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
</div>

<!-- NOTE: this JS must live here (not in our global JS file) because it relies
     on being processed by Jinja before it is run (specifically for replacing
     variables autoapi/trieste/models/gpflow/models/index and {'json_url': 'https://secondmind-labs.github.io/trieste/versions.json', 'version_match': '1.0.0'}.
-->

<script type="text/javascript">
// Check if corresponding page path exists in other version of docs
// and, if so, go there instead of the homepage of the other docs version
function checkPageExistsAndRedirect(event) {
    const currentFilePath = "autoapi/trieste/models/gpflow/models/index.html",
          tryUrl = event.target.getAttribute("href");
    let otherDocsHomepage = tryUrl.replace(currentFilePath, "");
    $.ajax({
        type: 'HEAD',
        url: tryUrl,
        // if the page exists, go there
        success: function() {
            location.href = tryUrl;
        }
    }).fail(function() {
        location.href = otherDocsHomepage;
    });
    // this prevents the browser from following the href of the clicked node
    // (which is fine because this function takes care of redirecting)
    return false;
}

// Populate the version switcher from the JSON config file
(function () {
    $.getJSON("https://secondmind-labs.github.io/trieste/versions.json", function(data, textStatus, jqXHR) {
        const currentFilePath = "autoapi/trieste/models/gpflow/models/index.html";
        // create links to the corresponding page in the other docs versions
        $.each(data, function(index, entry) {
            // if no custom name specified (e.g., "latest"), use version string
            if (!("name" in entry)) {
                entry.name = entry.version;
            }
            // create the node
            const node = document.createElement("a");
            node.setAttribute("class", "list-group-item list-group-item-action py-1");
            node.textContent = `${entry.name}`;
            node.setAttribute("href", `${entry.url}${currentFilePath}`);
            // on click, AJAX calls will check if the linked page exists before
            // trying to redirect, and if not, will redirect to the homepage
            // for that version of the docs.
            node.onclick = checkPageExistsAndRedirect;
            // Add dataset values for the version and name in case people want
            // to apply CSS styling based on this information.
            node.dataset["versionName"] = entry.name;
            node.dataset["version"] = entry.version;

            $("#version_switcher_menu").append(node);
            // replace dropdown button text with the preferred display name of
            // this version, rather than using sphinx's  variable.
            // also highlight the dropdown entry for the currently-viewed
            // version's entry
            if (entry.version == "1.0.0") {
                node.classList.add("active");
                let btn = document.getElementById("version_switcher_button");
                btn.innerText = btn.dataset["activeVersionName"] = entry.name;
                btn.dataset["activeVersion"] = entry.version;
            }
        });
    });
})();
</script>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/secondmind-labs/trieste" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-contents">
   Module Contents
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trieste.models.gpflow.models.GaussianProcessRegression">
     GaussianProcessRegression
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.GaussianProcessRegression.model">
       model
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.GaussianProcessRegression.predict_y">
       predict_y
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.GaussianProcessRegression.update">
       update
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.GaussianProcessRegression.covariance_between_points">
       covariance_between_points
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.GaussianProcessRegression.optimize">
       optimize
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.GaussianProcessRegression.find_best_model_initialization">
       find_best_model_initialization
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.GaussianProcessRegression.trajectory_sampler">
       trajectory_sampler
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.GaussianProcessRegression.get_internal_data">
       get_internal_data
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.GaussianProcessRegression.conditional_predict_f">
       conditional_predict_f
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.GaussianProcessRegression.conditional_predict_joint">
       conditional_predict_joint
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.GaussianProcessRegression.conditional_predict_f_sample">
       conditional_predict_f_sample
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.GaussianProcessRegression.conditional_predict_y">
       conditional_predict_y
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trieste.models.gpflow.models.SparseGaussianProcessRegression">
     SparseGaussianProcessRegression
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.SparseGaussianProcessRegression.model">
       model
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.SparseGaussianProcessRegression.predict_y">
       predict_y
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.SparseGaussianProcessRegression.optimize">
       optimize
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.SparseGaussianProcessRegression.update">
       update
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.SparseGaussianProcessRegression._update_inducing_variables">
       _update_inducing_variables
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.SparseGaussianProcessRegression.get_inducing_variables">
       get_inducing_variables
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.SparseGaussianProcessRegression.covariance_between_points">
       covariance_between_points
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.SparseGaussianProcessRegression.trajectory_sampler">
       trajectory_sampler
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.SparseGaussianProcessRegression.get_internal_data">
       get_internal_data
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trieste.models.gpflow.models.SparseVariational">
     SparseVariational
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.SparseVariational.model">
       model
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.SparseVariational.predict_y">
       predict_y
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.SparseVariational.update">
       update
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.SparseVariational.optimize">
       optimize
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.SparseVariational._update_inducing_variables">
       _update_inducing_variables
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.SparseVariational.get_inducing_variables">
       get_inducing_variables
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.SparseVariational.covariance_between_points">
       covariance_between_points
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.SparseVariational.trajectory_sampler">
       trajectory_sampler
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trieste.models.gpflow.models.VariationalGaussianProcess">
     VariationalGaussianProcess
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.VariationalGaussianProcess.model">
       model
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.VariationalGaussianProcess.predict_y">
       predict_y
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.VariationalGaussianProcess.update">
       update
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.VariationalGaussianProcess.optimize">
       optimize
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.VariationalGaussianProcess.get_inducing_variables">
       get_inducing_variables
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.VariationalGaussianProcess.trajectory_sampler">
       trajectory_sampler
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.VariationalGaussianProcess.covariance_between_points">
       covariance_between_points
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trieste.models.gpflow.models.MultifidelityAutoregressive">
     MultifidelityAutoregressive
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.MultifidelityAutoregressive.predict">
       predict
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.MultifidelityAutoregressive._calculate_residual">
       _calculate_residual
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.MultifidelityAutoregressive.sample">
       sample
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.MultifidelityAutoregressive.predict_y">
       predict_y
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.MultifidelityAutoregressive.update">
       update
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.MultifidelityAutoregressive.optimize">
       optimize
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.MultifidelityAutoregressive.covariance_with_top_fidelity">
       covariance_with_top_fidelity
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trieste.models.gpflow.models.MultifidelityNonlinearAutoregressive">
     MultifidelityNonlinearAutoregressive
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.MultifidelityNonlinearAutoregressive.sample">
       sample
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.MultifidelityNonlinearAutoregressive.predict">
       predict
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.MultifidelityNonlinearAutoregressive.predict_y">
       predict_y
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.MultifidelityNonlinearAutoregressive._sample_mean_and_var_at_fidelities">
       _sample_mean_and_var_at_fidelities
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.MultifidelityNonlinearAutoregressive._propagate_samples_through_level">
       _propagate_samples_through_level
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.MultifidelityNonlinearAutoregressive.update">
       update
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.MultifidelityNonlinearAutoregressive.optimize">
       optimize
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#trieste.models.gpflow.models.MultifidelityNonlinearAutoregressive.covariance_with_top_fidelity">
       covariance_with_top_fidelity
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="module-trieste.models.gpflow.models">
<span id="trieste-models-gpflow-models"></span><h1><a class="reference internal" href="#module-trieste.models.gpflow.models" title="trieste.models.gpflow.models"><code class="xref py py-mod docutils literal notranslate"><span class="pre">trieste.models.gpflow.models</span></code></a><a class="headerlink" href="#module-trieste.models.gpflow.models" title="Permalink to this headline">#</a></h1>
<div class="section" id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Permalink to this headline">#</a></h2>
<dl class="py class">
<dt id="trieste.models.gpflow.models.GaussianProcessRegression">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">GaussianProcessRegression</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gpflow.models.GPR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optimizer</span> <span class="p"><span class="pre">|</span></span> <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_kernel_samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_rff_features</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_decoupled_sampler</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#GaussianProcessRegression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.GaussianProcessRegression" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../interface/index.html#trieste.models.gpflow.interface.GPflowPredictor" title="trieste.models.gpflow.interface.GPflowPredictor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.gpflow.interface.GPflowPredictor</span></code></a>, <a class="reference internal" href="../../interfaces/index.html#trieste.models.interfaces.TrainableProbabilisticModel" title="trieste.models.interfaces.TrainableProbabilisticModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.TrainableProbabilisticModel</span></code></a>, <a class="reference internal" href="../../interfaces/index.html#trieste.models.interfaces.FastUpdateModel" title="trieste.models.interfaces.FastUpdateModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.FastUpdateModel</span></code></a>, <a class="reference internal" href="../interface/index.html#trieste.models.gpflow.interface.SupportsCovarianceBetweenPoints" title="trieste.models.gpflow.interface.SupportsCovarianceBetweenPoints"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.gpflow.interface.SupportsCovarianceBetweenPoints</span></code></a>, <a class="reference internal" href="../../interfaces/index.html#trieste.models.interfaces.SupportsGetInternalData" title="trieste.models.interfaces.SupportsGetInternalData"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.SupportsGetInternalData</span></code></a>, <a class="reference internal" href="../../interfaces/index.html#trieste.models.interfaces.HasTrajectorySampler" title="trieste.models.interfaces.HasTrajectorySampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.HasTrajectorySampler</span></code></a></p>
<p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">TrainableProbabilisticModel</span></code> wrapper for a GPflow <code class="xref py py-class docutils literal notranslate"><span class="pre">GPR</span></code>.</p>
<p>As Bayesian optimization requires a large number of sequential predictions (i.e. when maximizing
acquisition functions), rather than calling the model directly at prediction time we instead
call the posterior objects built by these models. These posterior objects store the
pre-computed Gram matrices, which can be reused to allow faster subsequent predictions. However,
note that these posterior objects need to be updated whenever the underlying model is changed
by calling <code class="xref py py-meth docutils literal notranslate"><span class="pre">update_posterior_cache()</span></code> (this
happens automatically after calls to <a class="reference internal" href="#trieste.models.gpflow.models.GaussianProcessRegression.update" title="trieste.models.gpflow.models.GaussianProcessRegression.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update()</span></code></a> or <span class="math notranslate nohighlight">\(optimize\)</span>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – The GPflow model to wrap.</p></li>
<li><p><strong>optimizer</strong> – The optimizer with which to train the model. Defaults to
<a class="reference internal" href="../../optimizer/index.html#trieste.models.optimizer.Optimizer" title="trieste.models.optimizer.Optimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Optimizer</span></code></a> with <code class="xref py py-class docutils literal notranslate"><span class="pre">Scipy</span></code>.</p></li>
<li><p><strong>num_kernel_samples</strong> – Number of randomly sampled kernels (for each kernel parameter) to
evaluate before beginning model optimization. Therefore, for a kernel with <cite>p</cite>
(vector-valued) parameters, we evaluate <cite>p * num_kernel_samples</cite> kernels.</p></li>
<li><p><strong>num_rff_features</strong> – The number of random Fourier features used to approximate the
kernel when calling <a class="reference internal" href="#trieste.models.gpflow.models.GaussianProcessRegression.trajectory_sampler" title="trieste.models.gpflow.models.GaussianProcessRegression.trajectory_sampler"><code class="xref py py-meth docutils literal notranslate"><span class="pre">trajectory_sampler()</span></code></a>. We use a default of 1000 as it
typically perfoms well for a wide range of kernels. Note that very smooth
kernels (e.g. RBF) can be well-approximated with fewer features.</p></li>
<li><p><strong>use_decoupled_sampler</strong> – If True use a decoupled random Fourier feature sampler, else
just use a random Fourier feature sampler. The decoupled sampler suffers less from
overestimating variance and can typically get away with a lower num_rff_features.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="trieste.models.gpflow.models.GaussianProcessRegression.model">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">model</span></code> &#x2192; <span class="pre">gpflow.models.GPR</span><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#GaussianProcessRegression.model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.GaussianProcessRegression.model" title="Permalink to this definition">#</a></dt>
<dd><p>The underlying GPflow model.</p>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.GaussianProcessRegression.predict_y">
<code class="sig-name descname"><span class="pre">predict_y</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#GaussianProcessRegression.predict_y"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.GaussianProcessRegression.predict_y" title="Permalink to this definition">#</a></dt>
<dd><p>Return the mean and variance of the independent marginal distributions at each point in
<code class="docutils literal notranslate"><span class="pre">query_points</span></code> for the observations, including noise contributions.</p>
<p>Note that this is not supported by all models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>query_points</strong> – The points at which to make predictions, of shape […, D].</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The mean and variance of the independent marginal distributions at each point in
<code class="docutils literal notranslate"><span class="pre">query_points</span></code>. For a predictive distribution with event shape E, the mean and
variance will both have shape […] + E.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.GaussianProcessRegression.update">
<code class="sig-name descname"><span class="pre">update</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#GaussianProcessRegression.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.GaussianProcessRegression.update" title="Permalink to this definition">#</a></dt>
<dd><p>Update the model given the specified <code class="docutils literal notranslate"><span class="pre">dataset</span></code>. Does not train the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> – The data with which to update the model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.GaussianProcessRegression.covariance_between_points">
<code class="sig-name descname"><span class="pre">covariance_between_points</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_points_1</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_points_2</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#GaussianProcessRegression.covariance_between_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.GaussianProcessRegression.covariance_between_points" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the posterior covariance between sets of query points.</p>
<div class="math notranslate nohighlight">
\[\Sigma_{12} = K_{12} - K_{x1}(K_{xx} + \sigma^2 I)^{-1}K_{x2}\]</div>
<p>Note that query_points_2 must be a rank 2 tensor, but query_points_1 can
have leading dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query_points_1</strong> – Set of query points with shape […, N, D]</p></li>
<li><p><strong>query_points_2</strong> – Sets of query points with shape [M, D]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Covariance matrix between the sets of query points with shape […, L, N, M]
(L being the number of latent GPs = number of output dimensions)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.GaussianProcessRegression.optimize">
<code class="sig-name descname"><span class="pre">optimize</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#GaussianProcessRegression.optimize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.GaussianProcessRegression.optimize" title="Permalink to this definition">#</a></dt>
<dd><p>Optimize the model with the specified <cite>dataset</cite>.</p>
<p>For <a class="reference internal" href="#trieste.models.gpflow.models.GaussianProcessRegression" title="trieste.models.gpflow.models.GaussianProcessRegression"><code class="xref py py-class docutils literal notranslate"><span class="pre">GaussianProcessRegression</span></code></a>, we (optionally) try multiple randomly sampled
kernel parameter configurations as well as the configuration specified when initializing
the kernel. The best configuration is used as the starting point for model optimization.</p>
<p>For trainable parameters constrained to lie in a finite interval (through a sigmoid
bijector), we begin model optimization from the best of a random sample from these
parameters’ acceptable domains.</p>
<p>For trainable parameters without constraints but with priors, we begin model optimization
from the best of a random sample from these parameters’ priors.</p>
<p>For trainable parameters with neither priors nor constraints, we begin optimization from
their initial values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> – The data with which to optimize the <cite>model</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.GaussianProcessRegression.find_best_model_initialization">
<code class="sig-name descname"><span class="pre">find_best_model_initialization</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_kernel_samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#GaussianProcessRegression.find_best_model_initialization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.GaussianProcessRegression.find_best_model_initialization" title="Permalink to this definition">#</a></dt>
<dd><p>Test <cite>num_kernel_samples</cite> models with sampled kernel parameters. The model’s kernel
parameters are then set to the sample achieving maximal likelihood.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>num_kernel_samples</strong> – Number of randomly sampled kernels to evaluate.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.GaussianProcessRegression.trajectory_sampler">
<code class="sig-name descname"><span class="pre">trajectory_sampler</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../../interfaces/index.html#trieste.models.interfaces.TrajectorySampler" title="trieste.models.interfaces.TrajectorySampler"><span class="pre">trieste.models.interfaces.TrajectorySampler</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#trieste.models.gpflow.models.GaussianProcessRegression" title="trieste.models.gpflow.models.GaussianProcessRegression"><span class="pre">GaussianProcessRegression</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#GaussianProcessRegression.trajectory_sampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.GaussianProcessRegression.trajectory_sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Return a trajectory sampler. For <a class="reference internal" href="#trieste.models.gpflow.models.GaussianProcessRegression" title="trieste.models.gpflow.models.GaussianProcessRegression"><code class="xref py py-class docutils literal notranslate"><span class="pre">GaussianProcessRegression</span></code></a>, we build
trajectories using a random Fourier feature approximation.</p>
<p>At the moment only models with single latent GP are supported.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The trajectory sampler.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.11)"><strong>NotImplementedError</strong></a> – If we try to use the
sampler with a model that has more than one latent GP.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.GaussianProcessRegression.get_internal_data">
<code class="sig-name descname"><span class="pre">get_internal_data</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#GaussianProcessRegression.get_internal_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.GaussianProcessRegression.get_internal_data" title="Permalink to this definition">#</a></dt>
<dd><p>Return the model’s training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The model’s training data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.GaussianProcessRegression.conditional_predict_f">
<code class="sig-name descname"><span class="pre">conditional_predict_f</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">additional_data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#GaussianProcessRegression.conditional_predict_f"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.GaussianProcessRegression.conditional_predict_f" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the marginal GP distribution at query_points conditioned on both the model
and some additional data, using exact formula. See <span id="id1">[<a class="reference internal" href="../../../index.html#id34" title="Clément Chevalier, David Ginsbourger, and Xavier Emery. Corrected kriging update formulae for batch-sequential data assimilation. In Mathematics of Planet Earth, pages 119–122. Springer, 2014.">CGE14</a>]</span>
(eqs. 8-10) for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query_points</strong> – Set of query points with shape [M, D]</p></li>
<li><p><strong>additional_data</strong> – Dataset with query_points with shape […, N, D] and observations
with shape […, N, L]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>mean_qp_new: predictive mean at query_points, with shape […, M, L],
and var_qp_new: predictive variance at query_points, with shape […, M, L]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.GaussianProcessRegression.conditional_predict_joint">
<code class="sig-name descname"><span class="pre">conditional_predict_joint</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">additional_data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#GaussianProcessRegression.conditional_predict_joint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.GaussianProcessRegression.conditional_predict_joint" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts the joint GP distribution at query_points conditioned on both the model
and some additional data, using exact formula. See <span id="id2">[<a class="reference internal" href="../../../index.html#id34" title="Clément Chevalier, David Ginsbourger, and Xavier Emery. Corrected kriging update formulae for batch-sequential data assimilation. In Mathematics of Planet Earth, pages 119–122. Springer, 2014.">CGE14</a>]</span>
(eqs. 8-10) for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query_points</strong> – Set of query points with shape [M, D]</p></li>
<li><p><strong>additional_data</strong> – Dataset with query_points with shape […, N, D] and observations
with shape […, N, L]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>mean_qp_new: predictive mean at query_points, with shape […, M, L],
and cov_qp_new: predictive covariance between query_points, with shape
[…, L, M, M]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.GaussianProcessRegression.conditional_predict_f_sample">
<code class="sig-name descname"><span class="pre">conditional_predict_f_sample</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">additional_data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#GaussianProcessRegression.conditional_predict_f_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.GaussianProcessRegression.conditional_predict_f_sample" title="Permalink to this definition">#</a></dt>
<dd><p>Generates samples of the GP at query_points conditioned on both the model
and some additional data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query_points</strong> – Set of query points with shape [M, D]</p></li>
<li><p><strong>additional_data</strong> – Dataset with query_points with shape […, N, D] and observations
with shape […, N, L]</p></li>
<li><p><strong>num_samples</strong> – number of samples</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>samples of f at query points, with shape […, num_samples, M, L]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.GaussianProcessRegression.conditional_predict_y">
<code class="sig-name descname"><span class="pre">conditional_predict_y</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">additional_data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#GaussianProcessRegression.conditional_predict_y"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.GaussianProcessRegression.conditional_predict_y" title="Permalink to this definition">#</a></dt>
<dd><p>Generates samples of y from the GP at query_points conditioned on both the model
and some additional data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query_points</strong> – Set of query points with shape [M, D]</p></li>
<li><p><strong>additional_data</strong> – Dataset with query_points with shape […, N, D] and observations
with shape […, N, L]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>predictive variance at query_points, with shape […, M, L],
and predictive variance at query_points, with shape […, M, L]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="trieste.models.gpflow.models.SparseGaussianProcessRegression">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">SparseGaussianProcessRegression</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gpflow.models.SGPR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optimizer</span> <span class="p"><span class="pre">|</span></span> <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_rff_features</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inducing_point_selector</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../inducing_point_selectors/index.html#trieste.models.gpflow.inducing_point_selectors.InducingPointSelector" title="trieste.models.gpflow.inducing_point_selectors.InducingPointSelector"><span class="pre">trieste.models.gpflow.inducing_point_selectors.InducingPointSelector</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#trieste.models.gpflow.models.SparseGaussianProcessRegression" title="trieste.models.gpflow.models.SparseGaussianProcessRegression"><span class="pre">SparseGaussianProcessRegression</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#SparseGaussianProcessRegression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.SparseGaussianProcessRegression" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../interface/index.html#trieste.models.gpflow.interface.GPflowPredictor" title="trieste.models.gpflow.interface.GPflowPredictor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.gpflow.interface.GPflowPredictor</span></code></a>, <a class="reference internal" href="../../interfaces/index.html#trieste.models.interfaces.TrainableProbabilisticModel" title="trieste.models.interfaces.TrainableProbabilisticModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.TrainableProbabilisticModel</span></code></a>, <a class="reference internal" href="../interface/index.html#trieste.models.gpflow.interface.SupportsCovarianceBetweenPoints" title="trieste.models.gpflow.interface.SupportsCovarianceBetweenPoints"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.gpflow.interface.SupportsCovarianceBetweenPoints</span></code></a>, <a class="reference internal" href="../../interfaces/index.html#trieste.models.interfaces.SupportsGetInducingVariables" title="trieste.models.interfaces.SupportsGetInducingVariables"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.SupportsGetInducingVariables</span></code></a>, <a class="reference internal" href="../../interfaces/index.html#trieste.models.interfaces.SupportsGetInternalData" title="trieste.models.interfaces.SupportsGetInternalData"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.SupportsGetInternalData</span></code></a>, <a class="reference internal" href="../../interfaces/index.html#trieste.models.interfaces.HasTrajectorySampler" title="trieste.models.interfaces.HasTrajectorySampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.HasTrajectorySampler</span></code></a></p>
<p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">TrainableProbabilisticModel</span></code> wrapper for a GPflow <code class="xref py py-class docutils literal notranslate"><span class="pre">SGPR</span></code>.
At the moment we only support models with a single latent GP. This is due to <code class="docutils literal notranslate"><span class="pre">compute_qu</span></code>
method in <code class="xref py py-class docutils literal notranslate"><span class="pre">SGPR</span></code> that is used for computing covariance between
query points and trajectory sampling, which at the moment works only for single latent GP.</p>
<p>Similarly to our <a class="reference internal" href="#trieste.models.gpflow.models.GaussianProcessRegression" title="trieste.models.gpflow.models.GaussianProcessRegression"><code class="xref py py-class docutils literal notranslate"><span class="pre">GaussianProcessRegression</span></code></a>, our <code class="xref py py-class docutils literal notranslate"><span class="pre">SGPR</span></code> wrapper
directly calls the posterior objects built by these models at prediction
time. These posterior objects store the pre-computed Gram matrices, which can be reused to allow
faster subsequent predictions. However, note that these posterior objects need to be updated
whenever the underlying model is changed  by calling <code class="xref py py-meth docutils literal notranslate"><span class="pre">update_posterior_cache()</span></code> (this
happens automatically after calls to <a class="reference internal" href="#trieste.models.gpflow.models.SparseGaussianProcessRegression.update" title="trieste.models.gpflow.models.SparseGaussianProcessRegression.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update()</span></code></a> or <span class="math notranslate nohighlight">\(optimize\)</span>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – The GPflow model to wrap.</p></li>
<li><p><strong>optimizer</strong> – The optimizer with which to train the model. Defaults to
<a class="reference internal" href="../../optimizer/index.html#trieste.models.optimizer.Optimizer" title="trieste.models.optimizer.Optimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Optimizer</span></code></a> with <code class="xref py py-class docutils literal notranslate"><span class="pre">Scipy</span></code>.</p></li>
<li><p><strong>num_rff_features</strong> – The number of random Fourier features used to approximate the
kernel when calling <a class="reference internal" href="#trieste.models.gpflow.models.SparseGaussianProcessRegression.trajectory_sampler" title="trieste.models.gpflow.models.SparseGaussianProcessRegression.trajectory_sampler"><code class="xref py py-meth docutils literal notranslate"><span class="pre">trajectory_sampler()</span></code></a>. We use a default of 1000 as it
typically perfoms well for a wide range of kernels. Note that very smooth
kernels (e.g. RBF) can be well-approximated with fewer features.</p></li>
<li><p><strong>inducing_point_selector</strong> – The (optional) desired inducing point selector that
will update the underlying GPflow SGPR model’s inducing points as
the optimization progresses.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.11)"><strong>NotImplementedError</strong></a><strong> (or </strong><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.11)"><strong>ValueError</strong></a><strong>)</strong> – If we try to use a model with invalid
<code class="docutils literal notranslate"><span class="pre">num_rff_features</span></code>, or an <code class="docutils literal notranslate"><span class="pre">inducing_point_selector</span></code> with a model
that has more than one set of inducing points.</p>
</dd>
</dl>
<dl class="py method">
<dt id="trieste.models.gpflow.models.SparseGaussianProcessRegression.model">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">model</span></code> &#x2192; <span class="pre">gpflow.models.SGPR</span><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#SparseGaussianProcessRegression.model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.SparseGaussianProcessRegression.model" title="Permalink to this definition">#</a></dt>
<dd><p>The underlying GPflow model.</p>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.SparseGaussianProcessRegression.predict_y">
<code class="sig-name descname"><span class="pre">predict_y</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#SparseGaussianProcessRegression.predict_y"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.SparseGaussianProcessRegression.predict_y" title="Permalink to this definition">#</a></dt>
<dd><p>Return the mean and variance of the independent marginal distributions at each point in
<code class="docutils literal notranslate"><span class="pre">query_points</span></code> for the observations, including noise contributions.</p>
<p>Note that this is not supported by all models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>query_points</strong> – The points at which to make predictions, of shape […, D].</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The mean and variance of the independent marginal distributions at each point in
<code class="docutils literal notranslate"><span class="pre">query_points</span></code>. For a predictive distribution with event shape E, the mean and
variance will both have shape […] + E.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.SparseGaussianProcessRegression.optimize">
<code class="sig-name descname"><span class="pre">optimize</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#SparseGaussianProcessRegression.optimize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.SparseGaussianProcessRegression.optimize" title="Permalink to this definition">#</a></dt>
<dd><p>Optimize the model with the specified <cite>dataset</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> – The data with which to optimize the <cite>model</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.SparseGaussianProcessRegression.update">
<code class="sig-name descname"><span class="pre">update</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#SparseGaussianProcessRegression.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.SparseGaussianProcessRegression.update" title="Permalink to this definition">#</a></dt>
<dd><p>Update the model given the specified <code class="docutils literal notranslate"><span class="pre">dataset</span></code>. Does not train the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> – The data with which to update the model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.SparseGaussianProcessRegression._update_inducing_variables">
<code class="sig-name descname"><span class="pre">_update_inducing_variables</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_inducing_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#SparseGaussianProcessRegression._update_inducing_variables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.SparseGaussianProcessRegression._update_inducing_variables" title="Permalink to this definition">#</a></dt>
<dd><p>When updating the inducing points of a model, we must also update the other
inducing variables, i.e. <cite>q_mu</cite> and <cite>q_sqrt</cite> accordingly. The exact form of this update
depends if we are using whitened representations of the inducing variables.
See <code class="xref py py-meth docutils literal notranslate"><span class="pre">_whiten_points()</span></code> for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>new_inducing_points</strong> – The desired values for the new inducing points.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.11)"><strong>NotImplementedError</strong></a> – If we try to update the inducing variables of a model
that has more than one set of inducing points.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.SparseGaussianProcessRegression.get_inducing_variables">
<code class="sig-name descname"><span class="pre">get_inducing_variables</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#SparseGaussianProcessRegression.get_inducing_variables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.SparseGaussianProcessRegression.get_inducing_variables" title="Permalink to this definition">#</a></dt>
<dd><p>Return the model’s inducing variables. The SGPR model does not have <code class="docutils literal notranslate"><span class="pre">q_mu</span></code>, <code class="docutils literal notranslate"><span class="pre">q_sqrt</span></code> and
<code class="docutils literal notranslate"><span class="pre">whiten</span></code> objects. We can use <code class="docutils literal notranslate"><span class="pre">compute_qu</span></code> method to obtain <code class="docutils literal notranslate"><span class="pre">q_mu</span></code> and <code class="docutils literal notranslate"><span class="pre">q_sqrt</span></code>,
while the SGPR model does not use the whitened representation. Note that at the moment
<code class="docutils literal notranslate"><span class="pre">compute_qu</span></code> works only for single latent GP and returns <code class="docutils literal notranslate"><span class="pre">q_sqrt</span></code> in a shape that is
inconsistent with the SVGP model (hence we need to do modify its shape).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The inducing points (i.e. locations of the inducing variables), as a Tensor or a
list of Tensors (when the model has multiple inducing points); a tensor containing the
variational mean <code class="docutils literal notranslate"><span class="pre">q_mu</span></code>; a tensor containing the Cholesky decomposition of the
variational covariance <code class="docutils literal notranslate"><span class="pre">q_sqrt</span></code>; and a bool denoting if we are using whitened or
non-whitened representations.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.11)"><strong>NotImplementedError</strong></a> – If the model has more than one latent GP.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.SparseGaussianProcessRegression.covariance_between_points">
<code class="sig-name descname"><span class="pre">covariance_between_points</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_points_1</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_points_2</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#SparseGaussianProcessRegression.covariance_between_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.SparseGaussianProcessRegression.covariance_between_points" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the posterior covariance between sets of query points.</p>
<p>Note that query_points_2 must be a rank 2 tensor, but query_points_1 can
have leading dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query_points_1</strong> – Set of query points with shape […, A, D]</p></li>
<li><p><strong>query_points_2</strong> – Sets of query points with shape [B, D]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Covariance matrix between the sets of query points with shape […, L, A, B]
(L being the number of latent GPs = number of output dimensions)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.SparseGaussianProcessRegression.trajectory_sampler">
<code class="sig-name descname"><span class="pre">trajectory_sampler</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../../interfaces/index.html#trieste.models.interfaces.TrajectorySampler" title="trieste.models.interfaces.TrajectorySampler"><span class="pre">trieste.models.interfaces.TrajectorySampler</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#trieste.models.gpflow.models.SparseGaussianProcessRegression" title="trieste.models.gpflow.models.SparseGaussianProcessRegression"><span class="pre">SparseGaussianProcessRegression</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#SparseGaussianProcessRegression.trajectory_sampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.SparseGaussianProcessRegression.trajectory_sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Return a trajectory sampler. For <a class="reference internal" href="#trieste.models.gpflow.models.SparseGaussianProcessRegression" title="trieste.models.gpflow.models.SparseGaussianProcessRegression"><code class="xref py py-class docutils literal notranslate"><span class="pre">SparseGaussianProcessRegression</span></code></a>, we build
trajectories using a decoupled random Fourier feature approximation. Note that this
is available only for single output models.</p>
<p>At the moment only models with single latent GP are supported.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The trajectory sampler.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.11)"><strong>NotImplementedError</strong></a> – If we try to use the
sampler with a model that has more than one latent GP.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.SparseGaussianProcessRegression.get_internal_data">
<code class="sig-name descname"><span class="pre">get_internal_data</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#SparseGaussianProcessRegression.get_internal_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.SparseGaussianProcessRegression.get_internal_data" title="Permalink to this definition">#</a></dt>
<dd><p>Return the model’s training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The model’s training data.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="trieste.models.gpflow.models.SparseVariational">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">SparseVariational</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gpflow.models.SVGP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optimizer</span> <span class="p"><span class="pre">|</span></span> <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_rff_features</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inducing_point_selector</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../inducing_point_selectors/index.html#trieste.models.gpflow.inducing_point_selectors.InducingPointSelector" title="trieste.models.gpflow.inducing_point_selectors.InducingPointSelector"><span class="pre">trieste.models.gpflow.inducing_point_selectors.InducingPointSelector</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#trieste.models.gpflow.models.SparseVariational" title="trieste.models.gpflow.models.SparseVariational"><span class="pre">SparseVariational</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#SparseVariational"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.SparseVariational" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../interface/index.html#trieste.models.gpflow.interface.GPflowPredictor" title="trieste.models.gpflow.interface.GPflowPredictor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.gpflow.interface.GPflowPredictor</span></code></a>, <a class="reference internal" href="../../interfaces/index.html#trieste.models.interfaces.TrainableProbabilisticModel" title="trieste.models.interfaces.TrainableProbabilisticModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.TrainableProbabilisticModel</span></code></a>, <a class="reference internal" href="../interface/index.html#trieste.models.gpflow.interface.SupportsCovarianceBetweenPoints" title="trieste.models.gpflow.interface.SupportsCovarianceBetweenPoints"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.gpflow.interface.SupportsCovarianceBetweenPoints</span></code></a>, <a class="reference internal" href="../../interfaces/index.html#trieste.models.interfaces.SupportsGetInducingVariables" title="trieste.models.interfaces.SupportsGetInducingVariables"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.SupportsGetInducingVariables</span></code></a>, <a class="reference internal" href="../../interfaces/index.html#trieste.models.interfaces.HasTrajectorySampler" title="trieste.models.interfaces.HasTrajectorySampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.HasTrajectorySampler</span></code></a></p>
<p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">TrainableProbabilisticModel</span></code> wrapper for a GPflow <code class="xref py py-class docutils literal notranslate"><span class="pre">SVGP</span></code>.</p>
<p>Similarly to our <a class="reference internal" href="#trieste.models.gpflow.models.GaussianProcessRegression" title="trieste.models.gpflow.models.GaussianProcessRegression"><code class="xref py py-class docutils literal notranslate"><span class="pre">GaussianProcessRegression</span></code></a>, our <code class="xref py py-class docutils literal notranslate"><span class="pre">SVGP</span></code> wrapper
directly calls the posterior objects built by these models at prediction
time. These posterior objects store the pre-computed Gram matrices, which can be reused to allow
faster subsequent predictions. However, note that these posterior objects need to be updated
whenever the underlying model is changed  by calling <code class="xref py py-meth docutils literal notranslate"><span class="pre">update_posterior_cache()</span></code> (this
happens automatically after calls to <a class="reference internal" href="#trieste.models.gpflow.models.SparseVariational.update" title="trieste.models.gpflow.models.SparseVariational.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update()</span></code></a> or <span class="math notranslate nohighlight">\(optimize\)</span>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – The underlying GPflow sparse variational model.</p></li>
<li><p><strong>optimizer</strong> – The optimizer with which to train the model. Defaults to
<a class="reference internal" href="../../optimizer/index.html#trieste.models.optimizer.BatchOptimizer" title="trieste.models.optimizer.BatchOptimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">BatchOptimizer</span></code></a> with <code class="xref py py-class docutils literal notranslate"><span class="pre">Adam</span></code> with
batch size 100.</p></li>
<li><p><strong>num_rff_features</strong> – The number of random Fourier features used to approximate the
kernel when performing decoupled Thompson sampling through
its <a class="reference internal" href="#trieste.models.gpflow.models.SparseVariational.trajectory_sampler" title="trieste.models.gpflow.models.SparseVariational.trajectory_sampler"><code class="xref py py-meth docutils literal notranslate"><span class="pre">trajectory_sampler()</span></code></a>. We use a default of 1000 as it typically
perfoms well for a wide range of kernels. Note that very smooth kernels (e.g. RBF)
can be well-approximated with fewer features.</p></li>
<li><p><strong>inducing_point_selector</strong> – The (optional) desired inducing_point_selector that
will update the underlying GPflow sparse variational model’s inducing points as
the optimization progresses.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.11)"><strong>NotImplementedError</strong></a> – If we try to use an inducing_point_selector with a model
that has more than one set of inducing points.</p>
</dd>
</dl>
<dl class="py method">
<dt id="trieste.models.gpflow.models.SparseVariational.model">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">model</span></code> &#x2192; <span class="pre">gpflow.models.SVGP</span><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#SparseVariational.model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.SparseVariational.model" title="Permalink to this definition">#</a></dt>
<dd><p>The underlying GPflow model.</p>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.SparseVariational.predict_y">
<code class="sig-name descname"><span class="pre">predict_y</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#SparseVariational.predict_y"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.SparseVariational.predict_y" title="Permalink to this definition">#</a></dt>
<dd><p>Return the mean and variance of the independent marginal distributions at each point in
<code class="docutils literal notranslate"><span class="pre">query_points</span></code> for the observations, including noise contributions.</p>
<p>Note that this is not supported by all models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>query_points</strong> – The points at which to make predictions, of shape […, D].</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The mean and variance of the independent marginal distributions at each point in
<code class="docutils literal notranslate"><span class="pre">query_points</span></code>. For a predictive distribution with event shape E, the mean and
variance will both have shape […] + E.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.SparseVariational.update">
<code class="sig-name descname"><span class="pre">update</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#SparseVariational.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.SparseVariational.update" title="Permalink to this definition">#</a></dt>
<dd><p>Update the model given the specified <code class="docutils literal notranslate"><span class="pre">dataset</span></code>. Does not train the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> – The data with which to update the model.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.SparseVariational.optimize">
<code class="sig-name descname"><span class="pre">optimize</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#SparseVariational.optimize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.SparseVariational.optimize" title="Permalink to this definition">#</a></dt>
<dd><p>Optimize the model with the specified <cite>dataset</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> – The data with which to optimize the <cite>model</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.SparseVariational._update_inducing_variables">
<code class="sig-name descname"><span class="pre">_update_inducing_variables</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_inducing_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#SparseVariational._update_inducing_variables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.SparseVariational._update_inducing_variables" title="Permalink to this definition">#</a></dt>
<dd><p>When updating the inducing points of a model, we must also update the other
inducing variables, i.e. <cite>q_mu</cite> and <cite>q_sqrt</cite> accordingly. The exact form of this update
depends if we are using whitened representations of the inducing variables.
See <code class="xref py py-meth docutils literal notranslate"><span class="pre">_whiten_points()</span></code> for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>new_inducing_points</strong> – The desired values for the new inducing points.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.11)"><strong>NotImplementedError</strong></a> – If we try to update the inducing variables of a model
that has more than one set of inducing points.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.SparseVariational.get_inducing_variables">
<code class="sig-name descname"><span class="pre">get_inducing_variables</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#SparseVariational.get_inducing_variables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.SparseVariational.get_inducing_variables" title="Permalink to this definition">#</a></dt>
<dd><p>Return the model’s inducing variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The inducing points (i.e. locations of the inducing variables), as a Tensor or a
list of Tensors (when the model has multiple inducing points); A tensor containing the
variational mean q_mu; a tensor containing the Cholesky decomposition of the variational
covariance q_sqrt; and a bool denoting if we are using whitened or
non-whitened representations.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.SparseVariational.covariance_between_points">
<code class="sig-name descname"><span class="pre">covariance_between_points</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_points_1</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_points_2</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#SparseVariational.covariance_between_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.SparseVariational.covariance_between_points" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the posterior covariance between sets of query points.</p>
<p>Note that query_points_2 must be a rank 2 tensor, but query_points_1 can
have leading dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query_points_1</strong> – Set of query points with shape […, A, D]</p></li>
<li><p><strong>query_points_2</strong> – Sets of query points with shape [B, D]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Covariance matrix between the sets of query points with shape […, L, A, B]
(L being the number of latent GPs = number of output dimensions)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.SparseVariational.trajectory_sampler">
<code class="sig-name descname"><span class="pre">trajectory_sampler</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../../interfaces/index.html#trieste.models.interfaces.TrajectorySampler" title="trieste.models.interfaces.TrajectorySampler"><span class="pre">trieste.models.interfaces.TrajectorySampler</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#trieste.models.gpflow.models.SparseVariational" title="trieste.models.gpflow.models.SparseVariational"><span class="pre">SparseVariational</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#SparseVariational.trajectory_sampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.SparseVariational.trajectory_sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Return a trajectory sampler. For <a class="reference internal" href="#trieste.models.gpflow.models.SparseVariational" title="trieste.models.gpflow.models.SparseVariational"><code class="xref py py-class docutils literal notranslate"><span class="pre">SparseVariational</span></code></a>, we build
trajectories using a decoupled random Fourier feature approximation.</p>
<p>At the moment only models with single latent GP are supported.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The trajectory sampler.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.11)"><strong>NotImplementedError</strong></a> – If we try to use the
sampler with a model that has more than one latent GP.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="trieste.models.gpflow.models.VariationalGaussianProcess">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">VariationalGaussianProcess</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">gpflow.models.VGP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optimizer</span> <span class="p"><span class="pre">|</span></span> <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_natgrads</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">natgrad_gamma</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_rff_features</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#VariationalGaussianProcess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.VariationalGaussianProcess" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../interface/index.html#trieste.models.gpflow.interface.GPflowPredictor" title="trieste.models.gpflow.interface.GPflowPredictor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.gpflow.interface.GPflowPredictor</span></code></a>, <a class="reference internal" href="../../interfaces/index.html#trieste.models.interfaces.TrainableProbabilisticModel" title="trieste.models.interfaces.TrainableProbabilisticModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.TrainableProbabilisticModel</span></code></a>, <a class="reference internal" href="../interface/index.html#trieste.models.gpflow.interface.SupportsCovarianceBetweenPoints" title="trieste.models.gpflow.interface.SupportsCovarianceBetweenPoints"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.gpflow.interface.SupportsCovarianceBetweenPoints</span></code></a>, <a class="reference internal" href="../../interfaces/index.html#trieste.models.interfaces.SupportsGetInducingVariables" title="trieste.models.interfaces.SupportsGetInducingVariables"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.SupportsGetInducingVariables</span></code></a>, <a class="reference internal" href="../../interfaces/index.html#trieste.models.interfaces.HasTrajectorySampler" title="trieste.models.interfaces.HasTrajectorySampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.HasTrajectorySampler</span></code></a></p>
<p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">TrainableProbabilisticModel</span></code> wrapper for a GPflow <code class="xref py py-class docutils literal notranslate"><span class="pre">VGP</span></code>.</p>
<p>A Variational Gaussian Process (VGP) approximates the posterior of a GP
using the multivariate Gaussian closest to the posterior of the GP by minimizing the
KL divergence between approximated and exact posteriors. See <span id="id3">[<a class="reference internal" href="../../../index.html#id23" title="Manfred Opper and Cédric Archambeau. The variational gaussian approximation revisited. Neural computation, 2009.">OA09</a>]</span>
for details.</p>
<p>The VGP provides (approximate) GP modelling under non-Gaussian likelihoods, for example
when fitting a classification model over binary data.</p>
<p>A whitened representation and (optional) natural gradient steps are used to aid
model optimization.</p>
<p>Similarly to our <a class="reference internal" href="#trieste.models.gpflow.models.GaussianProcessRegression" title="trieste.models.gpflow.models.GaussianProcessRegression"><code class="xref py py-class docutils literal notranslate"><span class="pre">GaussianProcessRegression</span></code></a>, our <code class="xref py py-class docutils literal notranslate"><span class="pre">VGP</span></code> wrapper
directly calls the posterior objects built by these models at prediction
time. These posterior objects store the pre-computed Gram matrices, which can be reused to allow
faster subsequent predictions. However, note that these posterior objects need to be updated
whenever the underlying model is changed  by calling <code class="xref py py-meth docutils literal notranslate"><span class="pre">update_posterior_cache()</span></code> (this
happens automatically after calls to <a class="reference internal" href="#trieste.models.gpflow.models.VariationalGaussianProcess.update" title="trieste.models.gpflow.models.VariationalGaussianProcess.update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update()</span></code></a> or <span class="math notranslate nohighlight">\(optimize\)</span>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – The GPflow <code class="xref py py-class docutils literal notranslate"><span class="pre">VGP</span></code>.</p></li>
<li><p><strong>optimizer</strong> – The optimizer with which to train the model. Defaults to
<a class="reference internal" href="../../optimizer/index.html#trieste.models.optimizer.Optimizer" title="trieste.models.optimizer.Optimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Optimizer</span></code></a> with <code class="xref py py-class docutils literal notranslate"><span class="pre">Scipy</span></code>.</p></li>
<li><p><strong>use_natgrads</strong> – If True then alternate model optimization steps with natural
gradient updates. Note that natural gradients requires
a <a class="reference internal" href="../../optimizer/index.html#trieste.models.optimizer.BatchOptimizer" title="trieste.models.optimizer.BatchOptimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">BatchOptimizer</span></code></a> wrapper with
<code class="xref py py-class docutils literal notranslate"><span class="pre">Optimizer</span></code> optimizer.</p></li>
<li><p><strong>num_rff_features</strong> – The number of random Fourier features used to approximate the
kernel when performing decoupled Thompson sampling through
its <a class="reference internal" href="#trieste.models.gpflow.models.VariationalGaussianProcess.trajectory_sampler" title="trieste.models.gpflow.models.VariationalGaussianProcess.trajectory_sampler"><code class="xref py py-meth docutils literal notranslate"><span class="pre">trajectory_sampler()</span></code></a>. We use a default of 1000 as it typically perfoms
well for a wide range of kernels. Note that very smooth kernels (e.g. RBF) can
be well-approximated with fewer features.</p></li>
</ul>
</dd>
<dt class="field-even">Natgrad_gamma</dt>
<dd class="field-even"><p>Gamma parameter for the natural gradient optimizer.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.11)"><strong>ValueError</strong></a><strong> (or </strong><strong>InvalidArgumentError</strong><strong>)</strong> – If <code class="docutils literal notranslate"><span class="pre">model</span></code>’s <code class="xref py py-attr docutils literal notranslate"><span class="pre">q_sqrt</span></code> is not rank 3
or if attempting to combine natural gradients with a <code class="xref py py-class docutils literal notranslate"><span class="pre">Scipy</span></code>
optimizer.</p>
</dd>
</dl>
<dl class="py method">
<dt id="trieste.models.gpflow.models.VariationalGaussianProcess.model">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">model</span></code> &#x2192; <span class="pre">gpflow.models.VGP</span><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#VariationalGaussianProcess.model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.VariationalGaussianProcess.model" title="Permalink to this definition">#</a></dt>
<dd><p>The underlying GPflow model.</p>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.VariationalGaussianProcess.predict_y">
<code class="sig-name descname"><span class="pre">predict_y</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#VariationalGaussianProcess.predict_y"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.VariationalGaussianProcess.predict_y" title="Permalink to this definition">#</a></dt>
<dd><p>Return the mean and variance of the independent marginal distributions at each point in
<code class="docutils literal notranslate"><span class="pre">query_points</span></code> for the observations, including noise contributions.</p>
<p>Note that this is not supported by all models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>query_points</strong> – The points at which to make predictions, of shape […, D].</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The mean and variance of the independent marginal distributions at each point in
<code class="docutils literal notranslate"><span class="pre">query_points</span></code>. For a predictive distribution with event shape E, the mean and
variance will both have shape […] + E.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.VariationalGaussianProcess.update">
<code class="sig-name descname"><span class="pre">update</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jitter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">DEFAULTS.JITTER</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#VariationalGaussianProcess.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.VariationalGaussianProcess.update" title="Permalink to this definition">#</a></dt>
<dd><p>Update the model given the specified <code class="docutils literal notranslate"><span class="pre">dataset</span></code>. Does not train the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> – The data with which to update the model.</p></li>
<li><p><strong>jitter</strong> – The size of the jitter to use when stabilizing the Cholesky decomposition of
the covariance matrix.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.VariationalGaussianProcess.optimize">
<code class="sig-name descname"><span class="pre">optimize</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#VariationalGaussianProcess.optimize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.VariationalGaussianProcess.optimize" title="Permalink to this definition">#</a></dt>
<dd><p><a class="reference internal" href="#trieste.models.gpflow.models.VariationalGaussianProcess" title="trieste.models.gpflow.models.VariationalGaussianProcess"><code class="xref py py-class docutils literal notranslate"><span class="pre">VariationalGaussianProcess</span></code></a> has a custom <cite>optimize</cite> method that (optionally) permits
alternating between standard optimization steps (for kernel parameters) and natural gradient
steps for the variational parameters (<cite>q_mu</cite> and <cite>q_sqrt</cite>). See <span id="id4">[<a class="reference internal" href="../../../index.html#id24" title="Hugh Salimbeni, Stefanos Eleftheriadis, and James Hensman. Natural gradients in practice: non-conjugate variational inference in gaussian process models. International Conference on Artificial Intelligence and Statistics, 2018.">SEH18</a>]</span>
for details. Using natural gradients can dramatically speed up model fitting, especially for
ill-conditioned posteriors.</p>
<p>If using natural gradients, our optimizer inherits the mini-batch behavior and number
of optimization steps as the base optimizer specified when initializing
the <a class="reference internal" href="#trieste.models.gpflow.models.VariationalGaussianProcess" title="trieste.models.gpflow.models.VariationalGaussianProcess"><code class="xref py py-class docutils literal notranslate"><span class="pre">VariationalGaussianProcess</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.VariationalGaussianProcess.get_inducing_variables">
<code class="sig-name descname"><span class="pre">get_inducing_variables</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#VariationalGaussianProcess.get_inducing_variables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.VariationalGaussianProcess.get_inducing_variables" title="Permalink to this definition">#</a></dt>
<dd><p>Return the model’s inducing variables. Note that GPflow’s VGP model is
hard-coded to use the whitened representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Tensors containing: the inducing points (i.e. locations of the inducing
variables); the variational mean q_mu; the Cholesky decomposition of the
variational covariance q_sqrt; and a bool denoting if we are using whitened
or non-whitened representations.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.VariationalGaussianProcess.trajectory_sampler">
<code class="sig-name descname"><span class="pre">trajectory_sampler</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../../interfaces/index.html#trieste.models.interfaces.TrajectorySampler" title="trieste.models.interfaces.TrajectorySampler"><span class="pre">trieste.models.interfaces.TrajectorySampler</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#trieste.models.gpflow.models.VariationalGaussianProcess" title="trieste.models.gpflow.models.VariationalGaussianProcess"><span class="pre">VariationalGaussianProcess</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#VariationalGaussianProcess.trajectory_sampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.VariationalGaussianProcess.trajectory_sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Return a trajectory sampler. For <a class="reference internal" href="#trieste.models.gpflow.models.VariationalGaussianProcess" title="trieste.models.gpflow.models.VariationalGaussianProcess"><code class="xref py py-class docutils literal notranslate"><span class="pre">VariationalGaussianProcess</span></code></a>, we build
trajectories using a decoupled random Fourier feature approximation.</p>
<p>At the moment only models with single latent GP are supported.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The trajectory sampler.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.11)"><strong>NotImplementedError</strong></a> – If we try to use the
sampler with a model that has more than one latent GP.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.VariationalGaussianProcess.covariance_between_points">
<code class="sig-name descname"><span class="pre">covariance_between_points</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_points_1</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_points_2</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#VariationalGaussianProcess.covariance_between_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.VariationalGaussianProcess.covariance_between_points" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the posterior covariance between sets of query points.</p>
<p>Note that query_points_2 must be a rank 2 tensor, but query_points_1 can
have leading dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query_points_1</strong> – Set of query points with shape […, A, D]</p></li>
<li><p><strong>query_points_2</strong> – Sets of query points with shape [B, D]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Covariance matrix between the sets of query points with shape […, L, A, B]
(L being the number of latent GPs = number of output dimensions)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="trieste.models.gpflow.models.MultifidelityAutoregressive">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">MultifidelityAutoregressive</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fidelity_models</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#trieste.models.gpflow.models.GaussianProcessRegression" title="trieste.models.gpflow.models.GaussianProcessRegression"><span class="pre">GaussianProcessRegression</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#MultifidelityAutoregressive"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.MultifidelityAutoregressive" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../../interfaces/index.html#trieste.models.interfaces.TrainableProbabilisticModel" title="trieste.models.interfaces.TrainableProbabilisticModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.TrainableProbabilisticModel</span></code></a></p>
<p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">TrainableProbabilisticModel</span></code> implementation of the model
from <span id="id5">[<a class="reference internal" href="../../../index.html#id8" title="M.C. Kennedy and A O'Hagan. Predicting the output from a complex computer code when fast approximations are available. Biometrika, 87:1–13, 03 2000.">KOHagan00</a>]</span>. This is a multi-fidelity model that works with an
arbitrary number of fidelities. It relies on there being a linear relationship
between fidelities, and may not perform well for more complex relationships.
Precisely, it models the relationship between sequential fidelities as</p>
<div class="math notranslate nohighlight">
\[f_{i}(x) = \rho f_{i-1}(x) + \delta(x)\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho\)</span> is a scalar and <span class="math notranslate nohighlight">\(\delta\)</span> models the residual between the fidelities.
The only base models supported in this implementation are <code class="xref py py-class docutils literal notranslate"><span class="pre">GPR</span></code> models.
Note: Currently only supports single output problems.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fidelity_models</strong> – List of
<a class="reference internal" href="#trieste.models.gpflow.models.GaussianProcessRegression" title="trieste.models.gpflow.models.GaussianProcessRegression"><code class="xref py py-class docutils literal notranslate"><span class="pre">GaussianProcessRegression</span></code></a>
models, one for each fidelity. The model at index 0 will be used as the signal model
for the lowest fidelity and models at higher indices will be used as the residual
model for each higher fidelity.</p>
</dd>
</dl>
<dl class="py method">
<dt id="trieste.models.gpflow.models.MultifidelityAutoregressive.predict">
<code class="sig-name descname"><span class="pre">predict</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#MultifidelityAutoregressive.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.MultifidelityAutoregressive.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predict the marginal mean and variance at query_points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>query_points</strong> – Query points with shape [N, D+1], where the
final column of the final dimension contains the fidelity of the query point</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>mean: The mean at query_points with shape [N, P],
and var: The variance at query_points with shape [N, P]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.MultifidelityAutoregressive._calculate_residual">
<code class="sig-name descname"><span class="pre">_calculate_residual</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">fidelity</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#MultifidelityAutoregressive._calculate_residual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.MultifidelityAutoregressive._calculate_residual" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the true residuals for a set of datapoints at a given fidelity.</p>
<p>Dataset should be made up of points that you have observations for at fidelity <cite>fidelity</cite>.
The residuals calculated here are the difference between the data and the prediction at the
lower fidelity multiplied by the rho value at this fidelity. This produces the training
data for the residual models.</p>
<div class="math notranslate nohighlight">
\[r_{i} = y - \rho_{i} * f_{i-1}(x)\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> – Dataset of points for which to calculate the residuals. Must have
observations at fidelity <cite>fidelity</cite>. Query points shape is [N, D], observations is [N,P].</p></li>
<li><p><strong>fidelity</strong> – The fidelity for which to calculate the residuals</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The true residuals at given datapoints for given fidelity, shape is [N,1].</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.MultifidelityAutoregressive.sample">
<code class="sig-name descname"><span class="pre">sample</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#MultifidelityAutoregressive.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.MultifidelityAutoregressive.sample" title="Permalink to this definition">#</a></dt>
<dd><p>Sample <cite>num_samples</cite> samples from the posterior distribution at <cite>query_points</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query_points</strong> – The query points at which to sample of shape [N, D+1], where the
final column of the final dimension contains the fidelity of the query point</p></li>
<li><p><strong>num_samples</strong> – The number of samples (S) to generate for each query point.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>samples from the posterior of shape […, S, N, P]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.MultifidelityAutoregressive.predict_y">
<code class="sig-name descname"><span class="pre">predict_y</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#MultifidelityAutoregressive.predict_y"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.MultifidelityAutoregressive.predict_y" title="Permalink to this definition">#</a></dt>
<dd><p>Predict the marginal mean and variance at <cite>query_points</cite> including observation noise</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>query_points</strong> – Query points with shape […, N, D+1], where the
final column of the final dimension contains the fidelity of the query point</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>mean: The mean at query_points with shape [N, P],
and var: The variance at query_points with shape [N, P]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.MultifidelityAutoregressive.update">
<code class="sig-name descname"><span class="pre">update</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#MultifidelityAutoregressive.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.MultifidelityAutoregressive.update" title="Permalink to this definition">#</a></dt>
<dd><p>Update the models on their corresponding data. The data for each model is
extracted by splitting the observations in <code class="docutils literal notranslate"><span class="pre">dataset</span></code> by fidelity level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> – The query points and observations for <em>all</em> the wrapped models.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.MultifidelityAutoregressive.optimize">
<code class="sig-name descname"><span class="pre">optimize</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#MultifidelityAutoregressive.optimize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.MultifidelityAutoregressive.optimize" title="Permalink to this definition">#</a></dt>
<dd><p>Optimize all the models on their corresponding data. The data for each model is
extracted by splitting the observations in <code class="docutils literal notranslate"><span class="pre">dataset</span></code>  by fidelity level.
Note that we have to code up a custom loss function when optimizing our residual
model, so that we can include the correlation parameter as an optimisation variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> – The query points and observations for <em>all</em> the wrapped models.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.MultifidelityAutoregressive.covariance_with_top_fidelity">
<code class="sig-name descname"><span class="pre">covariance_with_top_fidelity</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#MultifidelityAutoregressive.covariance_with_top_fidelity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.MultifidelityAutoregressive.covariance_with_top_fidelity" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the covariance of the output at <cite>query_point</cite> and a given fidelity with the
highest fidelity output at the same <cite>query_point</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>query_points</strong> – The query points to calculate the covariance for, of shape [N, D+1],
where the final column of the final dimension contains the fidelity of the query point</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The covariance with the top fidelity for the <cite>query_points</cite>, of shape [N, P]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="trieste.models.gpflow.models.MultifidelityNonlinearAutoregressive">
<em class="property"><span class="pre">class</span> </em><code class="sig-name descname"><span class="pre">MultifidelityNonlinearAutoregressive</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fidelity_models</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#trieste.models.gpflow.models.GaussianProcessRegression" title="trieste.models.gpflow.models.GaussianProcessRegression"><span class="pre">GaussianProcessRegression</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_monte_carlo_samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#MultifidelityNonlinearAutoregressive"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.MultifidelityNonlinearAutoregressive" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../../interfaces/index.html#trieste.models.interfaces.TrainableProbabilisticModel" title="trieste.models.interfaces.TrainableProbabilisticModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trieste.models.interfaces.TrainableProbabilisticModel</span></code></a></p>
<p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">TrainableProbabilisticModel</span></code> implementation of the model from
<span id="id6">[<a class="reference internal" href="../../../index.html#id57" title="P. Perdikaris, M. Raissi, A. Damianou, N.D. Lawrence, and G.E Karniadakis. Nonlinear information fusion algorithms for data-efficient multi-fidelity modelling. Proceedings of the Royal Society A: Mathematical, Physical and Engineering Sciences, 2017.">PRD+17</a>]</span>. This is a multifidelity model that works with
an arbitrary number of fidelities. It is capable of modelling both linear and non-linear
relationships between fidelities. It models the relationship between sequential fidelities as</p>
<div class="math notranslate nohighlight">
\[f_{i}(x) =  g_{i}(x, f_{*i-1}(x))\]</div>
<p>where <span class="math notranslate nohighlight">\(f{*i-1}\)</span> is the posterior of the previous fidelity.
The only base models supported in this implementation are <code class="xref py py-class docutils literal notranslate"><span class="pre">GPR</span></code> models.
Note: Currently only supports single output problems.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fidelity_models</strong> – List of
<a class="reference internal" href="#trieste.models.gpflow.models.GaussianProcessRegression" title="trieste.models.gpflow.models.GaussianProcessRegression"><code class="xref py py-class docutils literal notranslate"><span class="pre">GaussianProcessRegression</span></code></a>
models, one for each fidelity. The model at index 0 should take
inputs with the same number of dimensions as <cite>x</cite> and can use any kernel,
whilst the later models should take an extra input dimesion, and use the kernel
described in <span id="id7">[<a class="reference internal" href="../../../index.html#id57" title="P. Perdikaris, M. Raissi, A. Damianou, N.D. Lawrence, and G.E Karniadakis. Nonlinear information fusion algorithms for data-efficient multi-fidelity modelling. Proceedings of the Royal Society A: Mathematical, Physical and Engineering Sciences, 2017.">PRD+17</a>]</span>.</p></li>
<li><p><strong>num_monte_carlo_samples</strong> – The number of Monte Carlo samples to use for the
sections of prediction and sampling that require the use of Monte Carlo methods.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="trieste.models.gpflow.models.MultifidelityNonlinearAutoregressive.sample">
<code class="sig-name descname"><span class="pre">sample</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#MultifidelityNonlinearAutoregressive.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.MultifidelityNonlinearAutoregressive.sample" title="Permalink to this definition">#</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">num_samples</span></code> samples from the independent marginal distributions at
<code class="docutils literal notranslate"><span class="pre">query_points</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query_points</strong> – The points at which to sample, with shape […, N, D].</p></li>
<li><p><strong>num_samples</strong> – The number of samples at each point.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The samples, with shape […, S, N], where S is the number of samples.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.MultifidelityNonlinearAutoregressive.predict">
<code class="sig-name descname"><span class="pre">predict</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#MultifidelityNonlinearAutoregressive.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.MultifidelityNonlinearAutoregressive.predict" title="Permalink to this definition">#</a></dt>
<dd><p>Predict the marginal mean and variance at query_points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>query_points</strong> – Query points with shape […, N, D+1], where the
final column of the final dimension contains the fidelity of the query point</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>mean: The mean at query_points with shape […, N, P],
and var: The variance at query_points with shape […, N, P]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.MultifidelityNonlinearAutoregressive.predict_y">
<code class="sig-name descname"><span class="pre">predict_y</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#MultifidelityNonlinearAutoregressive.predict_y"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.MultifidelityNonlinearAutoregressive.predict_y" title="Permalink to this definition">#</a></dt>
<dd><p>Predict the marginal mean and variance at <cite>query_points</cite> including observation noise</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>query_points</strong> – Query points with shape […, N, D+1], where the
final column of the final dimension contains the fidelity of the query point</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>mean: The mean at query_points with shape [N, P],
and var: The variance at query_points with shape [N, P]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.MultifidelityNonlinearAutoregressive._sample_mean_and_var_at_fidelities">
<code class="sig-name descname"><span class="pre">_sample_mean_and_var_at_fidelities</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#MultifidelityNonlinearAutoregressive._sample_mean_and_var_at_fidelities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.MultifidelityNonlinearAutoregressive._sample_mean_and_var_at_fidelities" title="Permalink to this definition">#</a></dt>
<dd><p>Draw <cite>num_monte_carlo_samples</cite> samples of mean and variance from the model at the fidelities
passed in the final column of the query points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>query_points</strong> – Query points with shape […, N, D+1], where the
final column of the final dimension contains the fidelity of the query point</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>sample_mean: Samples of the mean at the query points with shape […, N, 1, S]
and sample_var: Samples of the variance at the query points with shape […, N, 1, S]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.MultifidelityNonlinearAutoregressive._propagate_samples_through_level">
<code class="sig-name descname"><span class="pre">_propagate_samples_through_level</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_point</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">fidelity</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_mean</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_var</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#MultifidelityNonlinearAutoregressive._propagate_samples_through_level"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.MultifidelityNonlinearAutoregressive._propagate_samples_through_level" title="Permalink to this definition">#</a></dt>
<dd><p>Propagate samples through a given fidelity.</p>
<p>This takes a set of query points without a fidelity column and calculates samples
at the given fidelity, using the sample means and variances from the previous fidelity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query_points</strong> – The query points to sample at, with no fidelity column,
with shape[…, N, D]</p></li>
<li><p><strong>fidelity</strong> – The fidelity to propagate the samples through</p></li>
<li><p><strong>sample_mean</strong> – Samples of the posterior mean at the previous fidelity,
with shape […, N, 1, S]</p></li>
<li><p><strong>sample_var</strong> – Samples of the posterior variance at the previous fidelity,
with shape […, N, 1, S]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>sample_mean: Samples of the posterior mean at the given fidelity,
of shape […, N, 1, S]
and sample_var: Samples of the posterior variance at the given fidelity,
of shape […, N, 1, S]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.MultifidelityNonlinearAutoregressive.update">
<code class="sig-name descname"><span class="pre">update</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#MultifidelityNonlinearAutoregressive.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.MultifidelityNonlinearAutoregressive.update" title="Permalink to this definition">#</a></dt>
<dd><p>Update the models on their corresponding data. The data for each model is
extracted by splitting the observations in <code class="docutils literal notranslate"><span class="pre">dataset</span></code> by fidelity level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> – The query points and observations for <em>all</em> the wrapped models.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.MultifidelityNonlinearAutoregressive.optimize">
<code class="sig-name descname"><span class="pre">optimize</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../data/index.html#trieste.data.Dataset" title="trieste.data.Dataset"><span class="pre">trieste.data.Dataset</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#MultifidelityNonlinearAutoregressive.optimize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.MultifidelityNonlinearAutoregressive.optimize" title="Permalink to this definition">#</a></dt>
<dd><p>Optimize all the models on their corresponding data. The data for each model is
extracted by splitting the observations in <code class="docutils literal notranslate"><span class="pre">dataset</span></code>  by fidelity level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> – The query points and observations for <em>all</em> the wrapped models.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="trieste.models.gpflow.models.MultifidelityNonlinearAutoregressive.covariance_with_top_fidelity">
<code class="sig-name descname"><span class="pre">covariance_with_top_fidelity</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="../../../types/index.html#trieste.types.TensorType" title="trieste.types.TensorType"><span class="pre">trieste.types.TensorType</span></a><a class="reference internal" href="../../../../../_modules/trieste/models/gpflow/models.html#MultifidelityNonlinearAutoregressive.covariance_with_top_fidelity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#trieste.models.gpflow.models.MultifidelityNonlinearAutoregressive.covariance_with_top_fidelity" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the covariance of the output at <cite>query_point</cite> and a given fidelity with the
highest fidelity output at the same <cite>query_point</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>query_points</strong> – The query points to calculate the covariance for, of shape [N, D+1],
where the final column of the final dimension contains the fidelity of the query point</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The covariance with the top fidelity for the <cite>query_points</cite>, of shape [N, P]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>


              </div>
              
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright Copyright 2020 The Trieste Contributors

Licensed under the Apache License, Version 2.0 (the &#34;License&#34;);
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an &#34;AS IS&#34; BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.4.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>